##============================================================================
##  The contents of this file are covered by the Viskores license. See
##  LICENSE.txt for details.
##
##  By contributing to this file, all contributors agree to the Developer
##  Certificate of Origin Version 1.1 (DCO 1.1) as stated in DCO.txt.
##============================================================================

##=============================================================================
##
##  Copyright (c) Kitware, Inc.
##  All rights reserved.
##  See LICENSE.txt for details.
##
##  This software is distributed WITHOUT ANY WARRANTY; without even
##  the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
##  PURPOSE.  See the above copyright notice for more information.
##
##=============================================================================

# VTK contract test: Build a minimal VTK with latest release to ensure compatibility
vtk_contract_test:
  extends:
    - .ubuntu2204
    - .run_automatically
    - .uo_cpu_tags
  stage: build
  timeout: 2 hours
  interruptible: true
  before_script:
    - .gitlab/ci/config/cmake.sh "${CMAKE_VERSION:-3.13.5}"
    - export PATH=$PWD/.gitlab/cmake/bin:$PATH
    - cmake --version
    - "cmake -VV -P .gitlab/ci/config/ninja.cmake"
    - export PATH="${PWD}/.gitlab:${PATH}"
  script:
    - .gitlab/ci/config/vtk_contract.sh
  allow_failure: false
